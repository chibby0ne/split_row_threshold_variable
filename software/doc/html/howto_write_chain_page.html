<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<title>Creonic Simulation Environment (CSE): How to set-up an own simulation chain</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javaScript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css"/>
</head>
<body onload='searchBox.OnSelectItem(0);'>
<!-- Generated by Doxygen 1.7.1 -->
<script type="text/javascript"><!--
var searchBox = new SearchBox("searchBox", "search",false,'Search');
--></script>
<div class="navigation" id="top">
  <div class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&nbsp;Page</span></a></li>
      <li class="current"><a href="pages.html"><span>Related&nbsp;Pages</span></a></li>
      <li><a href="modules.html"><span>Modules</span></a></li>
      <li><a href="namespaces.html"><span>Namespaces</span></a></li>
      <li><a href="annotated.html"><span>Classes</span></a></li>
      <li><a href="files.html"><span>Files</span></a></li>
      <li><a href="dirs.html"><span>Directories</span></a></li>
      <li><a href="examples.html"><span>Examples</span></a></li>
      <li id="searchli">
        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
          </span>
        </div>
      </li>
    </ul>
  </div>
</div>
<div class="header">
  <div class="headertitle">
<h1>How to set-up an own simulation chain </h1>  </div>
</div>
<div class="contents">
<p>Setting up a new specific simulation chain is a simple task with the CSE environment.</p>
<p>The process has the following steps:</p>
<ul>
<li><a class="el" href="howto_write_chain_page.html#inst_conf_res">Create an instance of the configuration class and the result class</a> </li>
<li><a class="el" href="howto_write_chain_page.html#inst_modules">Instantiate the functional modules</a> </li>
<li><a class="el" href="howto_write_chain_page.html#connect_modules">Connect the data ports of the modules</a> </li>
<li><a class="el" href="howto_write_chain_page.html#config_modules">Configure the modules</a> </li>
<li><a class="el" href="howto_write_chain_page.html#exec_modules">Execute the modules</a> </li>
<li><a class="el" href="howto_write_chain_page.html#write_res">Write the needed results to a result file</a> </li>
<li><a class="el" href="howto_write_chain_page.html#iter_over_var">Iterate over the defined iteration variable(s) in the XML file</a></li>
</ul>
<p>Create a new main file and include the cse_lib.h file and introduce the <a class="el" href="namespacecse__lib.html" title="Namespace for the Creonic simulation environment (CSE).">cse_lib</a> namespace. Copy an existing CMakeList.txt file and adapt the project name in it to get a cmake makefile. Now you have the start framework to set-up a new chain.</p>
<p>The following sections show the several steps at an example chain. The <a class="el" href="example_tukl_chain_8cpp-example.html">source code</a> of the chain is available as an example.</p>
<h2><a class="anchor" id="inst_conf_res"></a>
Create an instance of the configuration class and the result class</h2>
<p>These two classes are very easy and similar to use. They must be instantiated with the filenames as parameter.</p>
<div class="fragment"><pre class="fragment"><span class="preprocessor">#include &quot;cse_lib.h&quot;</span>

<span class="keyword">using namespace </span>cse_lib;

<span class="keywordtype">int</span> main()
{

    <a class="code" href="classManage__Module__Config.html" title="Manage the automatic configuration of the modules via a XML file.">Manage_Module_Config</a> xml_config(<span class="stringliteral">&quot;config.xml&quot;</span>);
    <a class="code" href="classManage__Module__Result.html" title="Manage the XML result file.">Manage_Module_Result</a> xml_result(<span class="stringliteral">&quot;result.xml&quot;</span>);
}
</pre></div><p>The <a class="el" href="classManage__Module__Config.html" title="Manage the automatic configuration of the modules via a XML file.">Manage_Module_Config</a> class parses the given XML file and creates and executes the described parameter units. In addition it handles the given iteration parameter(s).</p>
<p>The xml_result instance creates a new file. If the given file already exists the class will overwrite it!</p>
<h2><a class="anchor" id="inst_modules"></a>
Instantiate the functional modules</h2>
<p>You must create a new instance for each module you want to use in your chain. If you need a module twice, create two instances with different instance names to distinguish them.</p>
<p>The <a class="el" href="classManage__Module__Config.html" title="Manage the automatic configuration of the modules via a XML file.">Manage_Module_Config</a> class identifies the module instances by its instance name stored in the <a class="el" href="classcse__lib_1_1Base__Parameter.html#a573f2075961c4863b0473e57b2a8a04b" title="Instance name parameter.">cse_lib::Base_Parameter::instance_name</a> container.</p>
<div class="fragment"><pre class="fragment">    Source_Bits source_bits;
    Encoder_LDPC_GMR enc_ldpc;
    Interleaving_GMR&lt;unsigned int&gt; interleaver;
    interleaver.instance_name(<span class="stringliteral">&quot;Interleaver_GMR&quot;</span>);
    Mapper mapper;
    Channel_AWGN channel_awgn;
    Demapper demapper;
    Converter_Float_Fixpoint&lt;float, int&gt; converter;
    Interleaving_GMR&lt;int&gt; deinterleaver;
    deinterleaver.instance_name(<span class="stringliteral">&quot;Deinterleaver_GMR&quot;</span>);
    Decoder_LDPC_GMR dec_ldpc;
    Statistics_Error_Rates error_rates;
</pre></div><p>You see that we have two instances of the Interleaving module with two different names!</p>
<h2><a class="anchor" id="connect_modules"></a>
Connect the data ports of the modules</h2>
<p>The data ports of the modules can be easily connected. The input ports of the modules can be connected to an output port of another module. With this concept it is also possible to connect an output port to several input ports. Simple getter and setter code constructs handle this task.</p>
<div class="fragment"><pre class="fragment">    enc_ldpc.input_bits(source_bits.output_bits());
    interleaver.input(enc_ldpc.output_bits());
    mapper.input_bits(interleaver.output());
    channel_awgn.input_symb(mapper.output_symb());
    demapper.input_symb(channel_awgn.output_symb());
    converter.input(demapper.output_bits_llr());
    deinterleaver.input(converter.output());
    dec_ldpc.input_bits_llr(deinterleaver.output());
    error_rates.input_bits(dec_ldpc.output_bits());
    error_rates.input_bits_ref(source_bits.output_bits());
</pre></div><h2><a class="anchor" id="config_modules"></a>
Configure the modules</h2>
<p>The CSE infrastructure provides a comfortable way to configure the modules via the given XML file. The <a class="el" href="classManage__Module__Config.html" title="Manage the automatic configuration of the modules via a XML file.">Manage_Module_Config</a> instance configures the given module fully automatically. The identification is done via the instance name.</p>
<div class="fragment"><pre class="fragment">    xml_config.Configure_Module(source_bits);
    xml_config.Configure_Module(enc_ldpc);
    xml_config.Configure_Module(interleaver);
    xml_config.Configure_Module(mapper);
    xml_config.Configure_Module(channel_awgn);
    xml_config.Configure_Module(converter);
    xml_config.Configure_Module(demapper);
    xml_config.Configure_Module(deinterleaver);
    xml_config.Configure_Module(dec_ldpc);
    xml_config.Configure_Module(error_rates);
</pre></div><p> Remember, each time the configuration is changed (e.g., next point of iteration variable) the modules must be re-configured!</p>
<h2><a class="anchor" id="exec_modules"></a>
Execute the modules</h2>
<p>Each module has a <a class="el" href="classcse__lib_1_1Base__Interface.html#ad58b4b138f2293579de5180799bc73fd" title="Interface for scheduler, this function processes one block.">cse_lib::Base_Interface::Run()</a> function to calculate the new output data for one block. A while loop construct processes all blocks until a stopping condition is fulfilled. </p>
<div class="fragment"><pre class="fragment"><span class="keywordflow">do</span>
{
    source_bits.Run();
    enc_ldpc.Run();
    interleaver.Run();
    mapper.Run();

    channel_awgn.Run();

    demapper.Run();
    converter.Run();
    deinterleaver.Run();
    dec_ldpc.Run();
    result = error_rates.Run();
}
<span class="keywordflow">while</span>(result == 0);
</pre></div><p>The Statistics_Error_Rates instance error_rates counts the number of processed blocks and returns a specified value if the abort condition is true.</p>
<h2><a class="anchor" id="write_res"></a>
Write the needed results to a result file</h2>
<p>Writing the result, stored in the <a class="el" href="classcse__lib_1_1Status__Out.html">status output ports</a> of the modules is as easy as reading the configuration. A simple function call creates a sub-tree, which contains the current configuration. A second function allows to write the result from one module.</p>
<div class="fragment"><pre class="fragment">xml_result.Create_Iteration_Value_Result_Point(xml_config);
xml_result.Insert_Results_From_Module(demapper);
xml_result.Insert_Results_From_Module(error_rates);
xml_result.Write_Current_State();
</pre></div><p>The last function call writes the XML result file to the file system.</p>
<h2><a class="anchor" id="iter_over_var"></a>
Iterate over the defined iteration variable(s) in the XML file</h2>
<p>Iterating through all iteration points is quite easy. We have to add an additional do while construct around the configuration, execution, and writing results sections. </p>
<div class="fragment"><pre class="fragment"><span class="comment">// Instantiation</span>

{
  <span class="comment">// Configuration</span>

  <span class="keywordflow">do</span>
  {
    <span class="comment">// Execution</span>

  }
  <span class="keywordflow">while</span>(...)

  <span class="comment">// Writing results</span>

}
<span class="keywordflow">while</span>(xml_config.Update_To_Next_Iter() == 0);
</pre></div><p>That's it! You have built a new simulation chain with automatic configuration and storage of the results. </p>
</div>
<!--- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
<a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(0)"><span class="SelectionMark">&nbsp;</span>All</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(1)"><span class="SelectionMark">&nbsp;</span>Classes</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(2)"><span class="SelectionMark">&nbsp;</span>Namespaces</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(3)"><span class="SelectionMark">&nbsp;</span>Files</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(4)"><span class="SelectionMark">&nbsp;</span>Functions</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(5)"><span class="SelectionMark">&nbsp;</span>Variables</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(6)"><span class="SelectionMark">&nbsp;</span>Typedefs</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(7)"><span class="SelectionMark">&nbsp;</span>Enumerations</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(8)"><span class="SelectionMark">&nbsp;</span>Enumerator</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(9)"><span class="SelectionMark">&nbsp;</span>Friends</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(10)"><span class="SelectionMark">&nbsp;</span>Defines</a></div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<hr class="footer"/><address class="footer"><small>Generated by&nbsp;
<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.7.1 </small></address>
</body>
</html>
